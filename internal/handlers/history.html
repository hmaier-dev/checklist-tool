{{ define "history.html" }}
<div id="lastPages"></div>
<script>

const data = new FormData();
data.append('lastPages', localStorage.getItem('lastPages'));

fetch('/history-data', {
  method: "POST",
  body: data
})
.then(response => { 
  return response.json();
})
.then(data => { 
  localStorage.setItem('lastPages', JSON.stringify(data))
  console.log(localStorage.getItem('lastPages'))
})
.then(() => {
  // After the update generate the breadcrumb html
  htmx.ajax('POST', '/history-breadcrumb', { 
    target: '#lastPages',
    swap: 'innerHTML',
    values: { lastPages: localStorage.getItem('lastPages')}
    });
});

</script>
{{ end }}
